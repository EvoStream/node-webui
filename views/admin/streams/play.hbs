
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/images/fav-icon.ico" type='image/x-icon' >

    <title>Evostream Web UI Video</title>

    <!-- CSS -->

    <!-- Bootstrap -->
    <link rel="stylesheet" href="/css/bootstrap.css">
    <link rel="stylesheet" href="/css/bootstrap-social.css">
    <link rel="stylesheet" href="/css/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" href="/css/login-style.css">

    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400">

    <!-- Additional CSS Libraries for Admin Screens -->
    <link rel="stylesheet" href="/css/sb-admin.css">
    <link rel="stylesheet" href="/css/acute.select.css">
    <link rel="stylesheet" href="/css/bootstrap-table.css">
    <link rel="stylesheet" href="/css/video-player.css">
    <!-- Date Picker CSS -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css"/>

    <!-- CSS Styling Made by Web Designer-->
    <link rel="stylesheet" href="/css/admin-style.css">


    <!-- Javascript -->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/1/jquery.min.js"></script>
    <script type="text/javascript" src="/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/js/angular.min.js"></script>

    <!-- Additional JS Libraries for Admin Screens -->
    <!--<script type="text/javascript" src="/js/acute.select.js"></script>-->
    <!--<script type="text/javascript" src="/js/bootstrap-table.js"></script>-->
    <!--<script type="text/javascript" src="/js/bootstrap-table-angular.js"></script>-->

    <!-- Include Required Prerequisites -->
    <script type="text/javascript" src="//cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>

    <!-- Include Date Range Picker -->
    <script type="text/javascript" src="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>

    <!-- Players -->
    <!--html5 player -->
    <script src="//ers.evostream.com:5050/demo/js/evohtml5player-latest.bundle.js"></script>

    <!--dash-if player-->
    <script src="http://cdn.dashjs.org/latest/dash.all.min.js"></script>

    <!--videojs-->
    <!--<link href="http://vjs.zencdn.net/5.8.8/video-js.css" rel="stylesheet">-->
    <!--&lt;!&ndash; If you'd like to support IE8 &ndash;&gt;-->
    <!--<script src="http://vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js"></script>-->
    <!--<script src="http://vjs.zencdn.net/5.8.8/video.js"></script>-->

    <script>


        function $_GET(param) {
            var vars = {};
            window.location.href.replace(location.hash, '').replace(
                    /[?&]+([^=&]+)=?([^&]*)?/gi, // regexp
                    function (m, key, value) { // callback
                        vars[key] = value !== undefined ? value : '';
                    }
            );

            if (param) {
                return vars[param] ? vars[param] : null;
            }
            return vars;
        }

        //        var localStreamName = $_GET('localStreamName');

        function playWs(useSsl) {
//            if (window['player']) return;

            console.log('playWs playWs playWs ');

//            var emsIp = '50.56.172.81';
//            var streamName = '01';
            var emsIp = document.getElementById('emsIp').value;
            var streamName = document.getElementById('streamName').value;
            var opts = {
                emsIp: emsIp,
                streamName: streamName,
                videoTagId: 'videoHtml5Player',
                debugDivId: 'debugHtml5Player',
            };

            if (useSsl) {
                // This assumes that EMS has inboundWSSFMP4 acceptor (note WSS)
                // enabled pn port 8420 with acceptable certificate and key files
                //
                // If the certs are self signed and does not match the domain,
                // security exception needs to be added on the browser. This can be
                // done by going to https://<ems IP address>:<wss port>/ using the browser.
                // Example:
                // https://127.0.0.1:8420/
                // And then accepting the security exception option.
                opts.useSsl = true;
                opts.emsPort = 8420;
            }

            window['player'] = new EvoWsPlayer(opts);
            window['player'].play();
        }

        function playWrtc() {
//            if (window['player' + number]) return;

            var ersIp = document.getElementById('ersIp').value;
            var streamName = document.getElementById('streamName').value;
            var roomName = document.getElementById('roomName').value;
            var opts = {
                ersIp: ersIp,
                streamName: streamName,
                roomName: roomName,
                videoTagId: 'videoHtml5Player',
                debugDivId: 'debugHtml5Player',
            };

            window['player'] = new EvoWrtcPlayer(opts);
            window['player'].play();
        }

        function stop() {
            if (window['player']) {
                window['player'].stop();
                window['player'] = null;
            }
        }

        function showDebugMessages(show, number) {
            if (show) {
                document.getElementById('debugHtml5Player').style.display = "block";
            } else {
                document.getElementById('debugHtml5Player').style.display = "none";
            }
        }

    </script>

</head>
<body>
<div class="video">
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-md-push-2">
                {{#if PULL}}
                    <div>
                        <h3 class="evo-h3">EvoStream WebSocket/WebRTC Player</h3>
                        <div class="row">
                            <div class="col-md-10">
                                <p><label>localStreamName:&nbsp;</label>{{streamName}}</p>
                                <input type="hidden" id="emsIp" value="{{emsIp}}">
                                <input type="hidden" id="streamName" value="{{streamName}}">
                                <button class="btn btn-evo" onclick="playWs(false)">Play</button>
                                <button class="btn btn-evo-clear" onclick="stop()">Stop</button>
                                <br><br>
                                <video id="videoHtml5Player" class="videoElement" controls=""></video>
                                <!--<br>-->
                                <p>Show debug messages</p>
                                <!--<br>-->
                                <div id="debugHtml5Player" class="debugPane"></div>
                            </div>
                            <script>
                                playWs(false);
                            </script>
                        </div>
                    </div>
                {{/if}}

                {{#if VOD}}
                    <div>
                        <h3 class="evo-h3">EvoStream playing your VOD Stream</h3>
                        <div class="row">
                            <div class="col-md-10">
                                <p><label>url:&nbsp;</label>{{playUrl}}</p>
                                <video id=vod-video width=720 height=480 class="video-js vjs-default-skin" controls preload="auto">
                                    <source src="{{playUrl}}" type={{playType}}>
                                </video>
                                <link href="http://vjs.zencdn.net/5.8.8/video-js.css"  rel="stylesheet">
                                <!-- If you'd like to support IE8 -->
                                <script src="http://vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js"></script>
                                <script src="http://vjs.zencdn.net/5.8.8/video.js"></script>
                                <script>
                                    var player = videojs('vod-video');
                                    player.play();
                                </script>
                            </div>
                        </div>
                    </div>
                {{/if}}


                {{#if HLS}}
                    <div>
                        <h3 class="evo-h3">EvoStream playing your HLS Stream</h3>
                        <div class="row">
                            <div class="col-md-10">
                                <p><label>url:&nbsp;</label>{{playUrl}}</p>
                                <video id=hls-video width=720 height=480 class="video-js vjs-default-skin" controls>
                                    <!--<source src="http://solutions.brightcove.com/jwhisenant/hls/apple/bipbop/bipbopall.m3u8"-->
                                    <!--type="application/x-mpegURL">-->
                                    <!--<source src="http://50.56.172.81:3000/media/hls02/playlist.m3u8" type="application/x-mpegURL">-->
                                    <source src="{{playUrl}}" type="application/x-mpegURL">
                                </video>
                                <link href="http://vjs.zencdn.net/5.8.8/video-js.css" rel="stylesheet">
                                <!-- If you'd like to support IE8 -->
                                <script src="http://vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js"></script>
                                <script src="http://vjs.zencdn.net/5.8.8/video.js"></script>
                                <script src="/js/players/videojs-contrib-hls.js"></script>
                                <script>
                                    var player = videojs('hls-video');
                                    player.play();
                                </script>
                            </div>
                        </div>
                    </div>
                {{/if}}

                {{#if DASH}}
                    <div>
                        <h3 class="evo-h3">EvoStream playing your DASH Stream</h3>
                        <div class="row">
                            <div class="col-md-10">
                                <p><label>url:&nbsp;</label>{{playUrl}}</p>
                                <!--<video data-dashjs-player autoplay src="http://dash.edgesuite.net/envivio/EnvivioDash3/manifest.mpd" controls></video>-->
                                <!--<video data-dashjs-player autoplay src="http://50.56.172.81:3000/media/dash01/manifest.mpd" controls></video>-->
                                <video data-dashjs-player autoplay src="{{playUrl}}" controls></video>
                            </div>
                        </div>
                    </div>
                {{/if}}


                {{#if OTHERS}}
                    <div>
                        <h3 class="evo-h3">Player not available yet</h3>
                    </div>
                {{/if}}

            </div>
        </div>
    </div>
</div>
</body>
</html>


<script>


    //    var ws;
    //    var started = false;
    //
    //    function stop() {
    //        if (ws)
    //            ws.close();
    //
    //        stopPlayer();
    //        started = false;
    //    }
    //
    //    function startPlay(stream) {
    //
    //        console.log("startPlay inside");
    //
    //        // Prevent accidental double clicks
    //        if (started) return;
    //
    //        started = true;
    //
    //        console.log("startPlay before initializePlayer ");
    //
    //        initializePlayer();
    //
    //        console.log("startPlay after initializePlayer ");
    //
    //        var streamURI = "ws://50.56.172.81:8410/"+stream+"?progressive";
    //        var streamURI = "ws://50.56.172.81:8410/01?progressive";
    //
    //        console.log("streamURI "+streamURI);
    //
    //        //connect to the streaming server via WS
    //        ws = new WebSocket(streamURI);
    //        ws.binaryType = 'arraybuffer';
    //
    //        //setup the handler for when data arrives via WS
    //        ws.onmessage = function (msg) {
    //            var arrayView = new Uint8Array(msg.data);
    //            parseData(arrayView);
    //        };
    //    }
    //
    //    var localStreamName = $_GET('localStreamName');
    //
    //    startPlay(localStreamName);

</script>